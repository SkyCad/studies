<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Character Card</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

</head>
<body>
  <div class="character-card">
    <h2 id="char-name">Nom</h2>
    <div>
      <span class="badge bg-primary" id="char-class">Classe</span>
      <span class="badge bg-success" id="char-race">Race</span>
    </div>
    <div class="stats">
      <div><span class="stat-label">Endurance :</span> <span id="char-endurance">0</span></div>
      <div><span class="stat-label">Puissance :</span> <span id="char-power">0</span></div>
      <div><span class="stat-label">Défense magique :</span> <span id="char-magic-defense">0</span></div>
      <div><span class="stat-label">Puissance magique :</span> <span id="char-magic-power">0</span></div>
    </div>
    <button id="delete-char" class="btn btn-danger mt-3">Supprimer ce personnage</button>
  </div>
  <script>
    // Exemple d'utilisation avec le premier personnage du data.json
    let currentCharName = null;
    async function showCharacterFromJSON() {
      try {
        const response = await fetch('data.json');
        if (response.ok) {
          const gamedata = await response.text();
          const characters = JSON.parse(gamedata);
          if (Array.isArray(characters) && characters.length > 0) {
            const char = characters[0];
            currentCharName = char.name;
            document.getElementById('char-name').textContent = char.name;
            document.getElementById('char-class').textContent = char.charClass;
            document.getElementById('char-race').textContent = char.race;
            document.getElementById('char-endurance').textContent = char.endurance;
            document.getElementById('char-power').textContent = char.power;
            document.getElementById('char-magic-defense').textContent = char.magicDefense;
            document.getElementById('char-magic-power').textContent = char.magicPower;
          }
        }
      } catch (e) {
        // rien
      }
    }
    showCharacterFromJSON();

    // Suppression du personnage (dans localStorage uniquement)
    document.getElementById('delete-char').addEventListener('click', function() {
      // On supprime le personnage du localStorage.characters si présent
      let stored = localStorage.getItem('characters');
      if (stored) {
        try {
          let arr = JSON.parse(stored);
          if (Array.isArray(arr)) {
            arr = arr.filter(c => c.name !== currentCharName);
            localStorage.setItem('characters', JSON.stringify(arr));
          }
        } catch(e) {}
      }
      // Effet immédiat sur la carte
      if (confirm('Voulez-vous vraiment supprimer ce personnage ?')) {
        document.querySelector('.character-card').innerHTML = '<p class="text-danger">Personnage supprimé</p>';
      }
    });
  </script>
</body>
</html>
